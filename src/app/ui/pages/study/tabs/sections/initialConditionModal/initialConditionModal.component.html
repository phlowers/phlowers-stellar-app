<p-dialog
  dismissableMask="true"
  [visible]="isOpen()"
  (visibleChange)="onVisibleChange($event)"
  [style]="{ 'min-width': '50vw', 'max-width': '40.625rem' }"
  [modal]="true"
>
  <ng-template #header>
    <p class="text-l-600 mb-0 flex gap-2">
      @if (mode() === 'create') {
        <app-icon icon="add_circle" />
        <span i18n>Create an initial condition</span>
      } @else if (mode() === 'edit') {
        <app-icon icon="edit" />
        <span i18n>Edit an initial condition</span>
      } @else if (mode() === 'view') {
        <app-icon icon="visibility" />
        <span>{{ initialCondition().name }}</span>
      }
    </p>
  </ng-template>

  <div class="form">
    <dl class="form__col">
      <div>
        <dt i18n>Section name</dt>
        <dd class="read-only-info test">{{ section().name }}</dd>
      </div>

      <div>
        <dt i18n>Cable name</dt>
        <dd class="read-only-info test">{{ section().cable_name }}</dd>
      </div>

      <div>
        <dt i18n>Cables amount</dt>
        <dd class="read-only-info test">{{ section().cables_amount }}</dd>
      </div>
    </dl>

    <p-divider layout="vertical" />

    @if (mode() === 'create' || mode() === 'edit') {
      <div class="form__col form__col--right">
        <div>
          <label for="initial-condition-name">
            <ng-container i18n>Initial condition name </ng-container>
            <sup class="mandatory">*</sup>
          </label>
          <input
            name="initial-condition-name"
            required
            type="text"
            id="initial-condition-name"
            [attr.aria-invalid]="!isNameUnique()"
            aria-errormessage="initial-condition-name-error-message"
            pInputText
            [(ngModel)]="initialCondition().name"
            (ngModelChange)="onNameChange($event)"
          />
          @if (!isNameUnique()) {
            <p-message
              id="initial-condition-name-error-message"
              severity="error"
              size="small"
              variant="simple"
              i18n
            >
              Initial condition name must be unique.
            </p-message>
          }
        </div>
        <div>
          <label for="initial-condition-base-parameter" i18n>
            Base parameter
          </label>
          <input
            name="initial-condition-base-parameter"
            required
            type="text"
            id="initial-condition-base-parameter"
            pInputText
            [(ngModel)]="initialCondition().base_parameters"
          />
        </div>
        <div>
          <label for="initial-condition-base-temperature" i18n>
            Base temperature (°C)
          </label>
          <input
            name="initial-condition-base-temperature"
            required
            type="number"
            id="initial-condition-base-temperature"
            pInputText
            [(ngModel)]="initialCondition().base_temperature"
          />
        </div>
      </div>
    } @else if (mode() === 'view') {
      <dl class="form__col form__col--right">
        <div>
          <dt i18n>Initial condition name</dt>
          <dd class="read-only-info test">{{ initialCondition().name }}</dd>
        </div>

        <div>
          <dt i18n>Base parameter</dt>
          <dd class="read-only-info test">
            {{ initialCondition().base_parameters }}
          </dd>
        </div>

        <div>
          <dt i18n>Base temperature (°C)</dt>
          <dd class="read-only-info test">
            {{ initialCondition().base_temperature }}
          </dd>
        </div>
      </dl>
    }
  </div>

  <ng-template #footer>
    <button
      app-btn
      type="submit"
      btnSize="m"
      btnStyle="outlined"
      (click)="isOpenChange.emit(false)"
    >
      <app-icon icon="close" />
      <span i18n>Cancel</span>
    </button>
    @if (mode() !== 'view') {
      <button
        app-btn
        type="button"
        [disabled]="!this.initialCondition().name || !isNameUnique()"
        btnSize="m"
        (click)="onSubmit()"
      >
        <app-icon icon="check" />
        <span i18n>Validate</span>
      </button>
    }
  </ng-template>
</p-dialog>
